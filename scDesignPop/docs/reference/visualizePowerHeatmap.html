<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Visualize power as heatmaps across study designs — visualizePowerHeatmap • scDesignPop</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualize power as heatmaps across study designs — visualizePowerHeatmap"><meta name="description" content="Create a faceted heatmap showing statistical power across combinations of
numbers of individuals and numbers of cells per individual, optionally
stratified by method, cell types and genes (gene-SNP pairs)."><meta property="og:description" content="Create a faceted heatmap showing statistical power across combinations of
numbers of individuals and numbers of cells per individual, optionally
stratified by method, cell types and genes (gene-SNP pairs)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scDesignPop</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/scDesignPop.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/scDesignPop-celltype-prop-modeling.html">Model cell type proportions for new individuals</a></li>
    <li><a class="dropdown-item" href="../articles/scDesignPop-dynamic-eQTL-NL.html">Model nonlinear dynamic eQTL effects in continuous cell states</a></li>
    <li><a class="dropdown-item" href="../articles/scDesignPop-dynamic-eQTL.html">Model linear dynamic eQTL effects in continuous cell states</a></li>
    <li><a class="dropdown-item" href="../articles/scDesignPop-modify-eQTL-effects.html">Modify eQTL effect for eGenes / non-eGenes</a></li>
    <li><a class="dropdown-item" href="../articles/scDesignPop-power-analysis-ES-specification.html">Power analysis based on user specified eQTL effect sizes</a></li>
    <li><a class="dropdown-item" href="../articles/scDesignPop-power-analysis-fitted.html">Power analysis based on a fitted scDesignPop marginal model</a></li>
    <li><a class="dropdown-item" href="../articles/scDesignPop-power-analysis-selected.html">Power analysis for selected genes</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/chrisycd/scDesignPop/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualize power as heatmaps across study designs</h1>
      <small class="dont-index">Source: <a href="https://github.com/chrisycd/scDesignPop/blob/HEAD/R/powerAnalysis.R"><code>R/powerAnalysis.R</code></a></small>
      <div class="d-none name"><code>visualizePowerHeatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a faceted heatmap showing statistical power across combinations of
numbers of individuals and numbers of cells per individual, optionally
stratified by method, cell types and genes (gene-SNP pairs).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">visualizePowerHeatmap</span><span class="op">(</span></span>
<span>  <span class="va">power_result</span>,</span>
<span>  nindiv_col <span class="op">=</span> <span class="st">"nindiv"</span>,</span>
<span>  ncell_col <span class="op">=</span> <span class="st">"ncell"</span>,</span>
<span>  x_facet <span class="op">=</span> <span class="st">"celltype"</span>,</span>
<span>  y_facet <span class="op">=</span> <span class="st">"method"</span>,</span>
<span>  power_col <span class="op">=</span> <span class="st">"power"</span>,</span>
<span>  fill_label <span class="op">=</span> <span class="st">"Power"</span>,</span>
<span>  fill_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  facet_scales <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>  base_size <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-power-result">power_result<a class="anchor" aria-label="anchor" href="#arg-power-result"></a></dt>
<dd><p>A data frame containing the power estimates
to be visualized. It must include columns for the number of individuals,
number of cells per individual, the faceting variables, and the power
values. See <code>nindiv_col</code>, <code>ncell_col</code>, <code>x_facet</code>,
<code>y_facet</code>, and <code>power_col</code>.</p></dd>


<dt id="arg-nindiv-col">nindiv_col<a class="anchor" aria-label="anchor" href="#arg-nindiv-col"></a></dt>
<dd><p>A character string specifying the column in
<code>power_result</code> that stores the number of individuals in each design
setting. This column will be mapped to the x-axis (after being converted
to a factor).</p></dd>


<dt id="arg-ncell-col">ncell_col<a class="anchor" aria-label="anchor" href="#arg-ncell-col"></a></dt>
<dd><p>A character string specifying the column in
<code>power_result</code> that stores the number of cells per individual in each
design setting. This column will be mapped to the y-axis (after being
converted to a factor).</p></dd>


<dt id="arg-x-facet">x_facet<a class="anchor" aria-label="anchor" href="#arg-x-facet"></a></dt>
<dd><p>A character string specifying the column in
<code>power_result</code> to use for the row-wise facet (the left-to-right
“strips” in <code>facet_grid</code>). Typically this can be the cell types or genes.</p></dd>


<dt id="arg-y-facet">y_facet<a class="anchor" aria-label="anchor" href="#arg-y-facet"></a></dt>
<dd><p>A character string specifying the column in
<code>power_result</code> to use for the column-wise facet (the top-to-bottom
“strips” in <code>facet_grid</code>). Typically this can be the methods.</p></dd>


<dt id="arg-power-col">power_col<a class="anchor" aria-label="anchor" href="#arg-power-col"></a></dt>
<dd><p>A character string specifying the column in
<code>power_result</code> that contains the power values.</p></dd>


<dt id="arg-fill-label">fill_label<a class="anchor" aria-label="anchor" href="#arg-fill-label"></a></dt>
<dd><p>A character string giving the label for the fill legend
(e.g., <code>"Power"</code>).</p></dd>


<dt id="arg-fill-limits">fill_limits<a class="anchor" aria-label="anchor" href="#arg-fill-limits"></a></dt>
<dd><p>A numeric vector of length two giving the lower and upper
limits of the fill scale (e.g., <code>c(0, 1)</code>). Set to <code>NULL</code> to let
<span class="pkg">ggplot2</span> choose the limits automatically based on the data.</p></dd>


<dt id="arg-facet-scales">facet_scales<a class="anchor" aria-label="anchor" href="#arg-facet-scales"></a></dt>
<dd><p>A character string passed to the <code>scales</code> argument
of <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">ggplot2::facet_grid</a></code>. Must be one of <code>"fixed"</code>,
<code>"free"</code>, <code>"free_x"</code>, or <code>"free_y"</code>, controlling whether the
axes are shared or allowed to vary across facets.</p></dd>


<dt id="arg-base-size">base_size<a class="anchor" aria-label="anchor" href="#arg-base-size"></a></dt>
<dd><p>Numeric; base font size passed to
<code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">ggplot2::theme_minimal</a></code> to control overall text size in the plot.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ggplot</code> object representing the faceted power heatmap.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example toy data for power heatmap</span></span></span>
<span class="r-in"><span><span class="va">toy_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  nindiv   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ncell    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1000</span>, <span class="fl">500</span>, <span class="fl">1000</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  method   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model1"</span>, <span class="st">"model2"</span>,<span class="st">"model1"</span>, <span class="st">"model2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  celltype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bcell"</span>, <span class="st">"Tcell"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  power    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualize power heatmap</span></span></span>
<span class="r-in"><span><span class="fu">visualizePowerHeatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  power_result <span class="op">=</span> <span class="va">toy_df</span>,</span></span>
<span class="r-in"><span>  nindiv_col   <span class="op">=</span> <span class="st">"nindiv"</span>,</span></span>
<span class="r-in"><span>  ncell_col    <span class="op">=</span> <span class="st">"ncell"</span>,</span></span>
<span class="r-in"><span>  x_facet      <span class="op">=</span> <span class="st">"celltype"</span>,</span></span>
<span class="r-in"><span>  y_facet      <span class="op">=</span> <span class="st">"method"</span>,</span></span>
<span class="r-in"><span>  power_col    <span class="op">=</span> <span class="st">"power"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualizePowerHeatmap-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chris Y. Dong, Yihui Cen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

